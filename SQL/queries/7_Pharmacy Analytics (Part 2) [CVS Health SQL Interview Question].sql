--CVS Health is analyzing its pharmacy sales data, and how well different products are selling in the market. 
--Each drug is exclusively manufactured by a single manufacturer.

--Write a query to identify the manufacturers associated 
--with the drugs that resulted in losses for CVS Health and calculate the total amount of losses incurred.

--Output the manufacturer's name, the number of drugs associated with losses, 
--and the total losses in absolute value. (ABS FUNCTION)
--Display the results sorted in descending order with the highest losses displayed at the top.

--===LOSSES = TOTAL_SALES - COGS ===IF THIS AMOUNT COMES IN - SIGN THAN WE WILL CONSDER IT AS A LOSS

SELECT manufacturer,COUNT(DRUG) AS NO_OF_DRUGS,ABS(SUM(TOTAL_SALES - COGS)) AS TOTAL_LOSS_ABS
FROM PHARMACY_SALES
WHERE TOTAL_SALES - COGS <0
GROUP BY manufacturer
ORDER BY TOTAL_LOSS_ABS DESC




CREATE TABLE PHARMACY_SALES
(
product_id INT,
units_sold INT,
total_sales DECIMAL(18,2),
cogs  DECIMAL(18,2),----------------cost of goods sales
manufacturer  VARCHAR(100),
drug  VARCHAR(100),
total_loss INT ,----------NULL
total_profit INT,----------NULL
total INT------NULL
)

--INSERT INTO PHARMACY_SALES VALUES(156,89514,3130097,3427421.73,'Biogen','Acyclovir',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(25,222331,2753546,2974975.36,'AbbVie','Lamivudine and Zidovudine',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(50,90484,2521023.73,2742445.9,'Eli Lilly','Dermasorb TA Complete Kit',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(41,189925,3499574.92,3692136.66,'AbbVie','Clarithromycin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(63,93513,2104765,2462370.76,'Johnson & Johnson','Pepcid AC Acid Reducer',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(8,177270,2930134.52,3035522.06,'Johnson & Johnson','Nicorobin Clean and Clear',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(75,164674,1184664.57,1285326.93,'Eli Lilly','RED GINSENG FERMENTED ESSENCE BB',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(91,97765,1115255.32,1201044.27,'Roche','Hydrochlorothiazide',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(26,126866,1499768.09,1573992.41,'Eli Lilly','LBel',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(16,51707,1304837.86,1378790.53,'Roche','Topcare Tussin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(80,61467,3740527.69,3804542.2,'Biogen','Losartan Potassium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(148,104637,837620.18,931084.25,'Johnson & Johnson','Motrin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(95,128494,723841.23,779520.88,'Biogen','Wal-Zan',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(56,86598,1755300.92,1806344.97,'Eli Lilly','Spot Repairing Serum',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(71,126265,2564743.39,2593528.67,'Bayer','ENALAPRIL MALEATE',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(35,87449,86938.27,99811.26,'Johnson & Johnson','Sanitary Wipes Plus',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(70,167190,1119479.36,1313174.69,'Johnson & Johnson','Zyrtec Ultra-Strength',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(15,118901,2717420.96,2707620.02,'Biogen','Clotrimazole',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(33,149895,949514.05,921206.75,'Bayer','Levofloxacin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(179,125006,1825970,1769907.97,'Biogen','Lancome Paris Renergie Lift Volumetry',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(21,50550,697276.33,640063.57,'Pfizer','Venlafaxine Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(125,101102,566696,508144.71,'AbbVie','Lidocaine Hydrochloride and Epinephri',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(76,87699,3257976.38,3389863.82,'Johnson & Johnson','EltaMD SPF 150 Sun Screen',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(136,144814,1084258,1006447.73,'Biogen','Burkhart',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(34,94698,600997.19,521182.16,'AstraZeneca','Surmontil',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(61,77023,500101.61,419174.97,'Biogen','Varicose Relief',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(9,37410,293452.54,208876.01,'Eli Lilly','Zyprexa',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(67,87756,1112253.82,1021908.39,'Biogen','Pramipexole Dihydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(105,97736,537795,426539.59,'Pfizer','Diaper Rash Skin Protectant Crema Cer',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(107,160617,2538701.5,2414037.51,'Biogen','N - TIME SINUS',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(89,61832,1084996.13,940593.68,'Sanofi','Locoid',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(30,142661,1615518.35,1439533.27,'Sanofi','Oxaprozin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(47,130448,461623.76,282038.76,'Eli Lilly','Night Time Cherry Syrup',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(146,71159,1778024,1598276.66,'AstraZeneca','PDI Sani-Hands for Kids',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(52,47310,1151498.6,956693.99,'AstraZeneca','Armour Thyroid',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(183,155058,1220029.58,1023275.76,'AbbVie','Lexapro',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(113,122655,1358711.57,1161623.36,'Novartis','Famotidine',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(29,217652,3106931.54,2898165.87,'AstraZeneca','MiraLAX',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(171,177686,632705.44,413382.39,'AstraZeneca','lansoprazole',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(2,284705,523311.9,302721.56,'Novartis','Imatinib',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(126,165665,586961.45,365016.1,'AbbVie','Hamamelis Virginiana Kit Refill',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(122,187110,681903.65,458208.23,'GlaxoSmithKline','eszopiclone',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(144,110672,841911.12,616632.58,'Bayer','Acyclovir Sodium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(14,55657,933692.06,707891.52,'Bayer','Triple Complex Brain Tonic',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(97,128893,1114438.97,887895.38,'AbbVie','Sodium Iodide I 123',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(111,152231,2708053.52,2467067.02,'Eli Lilly','Divalproex Sodium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(31,94969,1104640.13,848011.39,'Biogen','Orsythia',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(51,95572,2582349,2322161.57,'Pfizer','Methadone Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(181,104441,1045454.54,772824.85,'Merck','FLU KIDS RELIEF',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(135,160565,2524229,2249571,'Bayer','Meloxicam',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(22,143516,3147031.19,2864248.62,'Sanofi','Synthroid',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(37,232228,507628.5,212607.07,'Johnson & Johnson','Hand wash',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(154,96249,1408872.02,1105672.68,'Eli Lilly','Potassium Chloride in Dextrose and So',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(59,215282,3059122.36,2755697.86,'Johnson & Johnson','Common Sagebrush',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(81,117947,1559816,1233306.52,'Merck','DHEA',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(3,192608,2851411.66,2522812.85,'Eli Lilly','Treflan',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(53,121093,1460189.98,1124982.66,'Biogen','Active-Medicated specimen collection',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(160,97520,1415772.18,1067854.28,'AbbVie','Olay Total Effects Pore Minimizing CC',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(46,189293,1528747.03,1172798.04,'Pfizer','Stay Awake',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(85,112969,2996318.23,2614556.03,'Bayer','Lovastatin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(143,180697,1364046.09,961852.31,'Eli Lilly','Western Family Pain Relieving',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(83,106994,1803199.39,1397575.13,'Eli Lilly','IOPE RETIGEN MOISTURE FOUNDATION',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(165,121043,961716.2,553770.53,'Bayer','PROMETHAZINE HYDROCHLORIDE',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(42,116447,2429913,2002106.22,'Biogen','Gelato Topical Anesthetic',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(157,197527,2204939.12,1749148.23,'Biogen','Non Aspirin PM',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(11,135549,2792775.1,2327541.25,'Biogen','AVAPRO',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(49,95307,700562.13,221803.73,'Biogen','Brucella Remedy',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(115,102792,821214.25,321027.88,'Pfizer','Methylphenidate Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(18,58580,1342015.48,838168.71,'AstraZeneca','Enalapril Maleate',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(119,214488,657085.12,152614.97,'Johnson & Johnson','Hand Sanitizer with Moisturizers',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(137,128175,822716.26,316753.86,'AbbVie','Warfarin Sodium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(169,95653,1270441.66,757724.19,'Eli Lilly','Multi Symptom Cold',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(164,89816,1080726.88,565920.33,'Biogen','RED ORANGE SUN',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(117,191289,778332.7,256621.14,'Bayer','Diphenhydramine HCL',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(106,103889,1698544.77,1164637.24,'Roche','Crab',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(120,148170,1094440.19,560320.28,'Bayer','Gabapentin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(10,123832,1518343,981993.64,'Novartis','Amoxicillin and Clavulanate Potassium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(6,64028,1253627.93,715430.59,'Bayer','Riociguat',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(186,150221,3116140.22,2560951.38,'Novartis','ANASTROZOLE',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(139,38522,674397.16,92756.59,'Merck','METHOCARBAMOL',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(100,212506,3091720.63,2509926.79,'Pfizer','Ropinirole Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(84,174098,2752163,2146503.01,'Pfizer','Tranexamic Acid',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(45,144352,708891.28,95912.97,'Roche','Dorzolamide HCl',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(112,92168,1194250.01,575583.41,'Novartis','Alimta',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(167,186778,904145,240493.13,'Biogen','Monistat Complete Care Instant Itch R',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(28,113370,1379945.1,712265.84,'AstraZeneca','Thyroid Assist',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(188,123956,1658835.03,991099.63,'Roche','Nivolumab',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(94,132362,2041758.41,1373721.7,'Biogen','UP and UP',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(98,110746,813188.82,140422.87,'Biogen','Medi-Chord',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(65,151901,967632.61,278350.32,'AbbVie','Moxifloxacin Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(124,59167,1033654.77,344270,'Bayer','MooreBrand Ibuprofen',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(23,72264,1892705.42,1202177.41,'Roche','Cloves',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(149,171975,1727624.67,1024897.45,'Johnson & Johnson','SunZone Work Sunscreen SPF-60',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(64,69702,1425027.99,710573.44,'AbbVie','Allopurinol',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(118,131788,1336647.6,595485.21,'AbbVie','Chlorzoxazone',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(123,125721,1796908.48,1041602.54,'Novartis','Diltiazem Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(88,175710,1443369.73,670011.51,'Bayer','Oxygen',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(24,289121,937901.5,163610.19,'AstraZeneca','BANANA BOAT SUNSCREEN',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(60,260823,2341257.97,1553229.42,'Eli Lilly','Metoclopramide',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(172,78481,985931,192743.12,'Bayer','Xarelto',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(161,175833,1201626.71,407210.29,'AbbVie','Citalopram',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(184,40007,875514.67,64948.76,'Biogen','Imraldi',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(127,139627,2912543.88,2095983.81,'AstraZeneca','Pravastatin Sodium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(20,201740,2937100,2117864.7,'Eli Lilly','Levothyroxine Sodium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(180,88653,2115658,1278017.17,'Pfizer','Ciprofloxacin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(69,72195,1862729.02,1021659.26,'Biogen','Prednisone',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(72,159597,1752274.54,907074.49,'Johnson & Johnson','Flu-Cold',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(1,166050,1857681.77,999626.88,'Eli Lilly','Keflex',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(48,157217,2878612.16,2020543.63,'Sanofi','Persantine',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(27,153025,1793428.19,908662.72,'Eli Lilly','Cefaclor',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(99,104368,1146201.6,250683.09,'AbbVie','Hydralazine Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(43,176445,1355861.1,412421.37,'Bayer','Citalopram Hydrobromide',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(176,71329,2529937.41,1584233.81,'Biogen','RHIZOPUS ARRHIZUS VAR ARRHIZUS',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(40,136973,2723073.91,1765245.63,'Pfizer','Selegiline Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(131,48864,1540350.32,569738.58,'Biogen','ESIKA',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(116,76115,2510105,1505831.15,'Biogen','Namenda',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(93,175376,2218026.75,1206180.64,'Biogen','ProBLEN Estrogen and Progesterone',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(170,107101,1958490.97,914881.77,'AstraZeneca','Double Antibiotic',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(54,68593,1545347.97,482212.61,'Eli Lilly','Diclofenac Sodium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(44,131514,3080474.64,2014858.59,'Biogen','Alprazolam',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(17,121564,1466145.44,387524.97,'AstraZeneca','SPRYCEL',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(86,147885,1808978.69,720231.01,'Pfizer','Divalproex Sodium Extended-Release',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(178,109829,2786292.44,1693474.52,'Roche','Motion Sickness II',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(87,110248,1485507.76,352858.53,'AbbVie','Night-Time Original',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(104,182090,3217507.49,2069390.45,'AbbVie','Stavudine',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(109,118696,1433109.5,263857.96,'Eli Lilly','Tizanidine Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(150,201167,2468436,1298844.51,'Biogen','Nefazodone Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(155,167357,2257132.08,1072766.97,'AstraZeneca','Zavesca',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(128,103246,2700252,1511930.53,'Biogen','QUETIAPINE FUMARATE',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(96,102627,1879590.38,669228.79,'AstraZeneca','Listerine Ultraclean Antiseptic',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(141,113510,2748508,1519635.54,'Eli Lilly','Kentucky Bluegrass (June), Standardiz',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(57,139567,2928590.94,1698018.23,'AbbVie','Valproic Acid',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(140,210120,2944223.22,1649161.98,'Roche','Lucentis',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(66,134990,1734572,436399.12,'Novartis','Antiseptic Hand Gel',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(77,66608,1406533.69,107902.51,'Johnson & Johnson','Budpak Petroleum Jelly',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(185,137096,2582356,1281909.78,'Pfizer','clobetasol propionate',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(138,154713,1743859.96,398395.47,'Eli Lilly','Treatment Set TS347116',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(142,122444,1428293.39,82371.13,'Roche','Herceptin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(134,37293,3485649.76,2128714.17,'Eli Lilly','Eldepryl',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(159,109063,1780520.27,423335.39,'Eli Lilly','Levetiracetam',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(102,71484,1442991.59,82418.43,'AstraZeneca','Naproxen Sodium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(5,231084,1825783.98,453989.65,'Biogen','DIPHENHYDRAMINE HYDROCHLORIDE',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(78,107503,2108286,694560.97,'Eli Lilly','Rimmel London',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(90,129019,2543749.63,1096231.45,'Biogen','KADCYLA',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(38,85086,3358913.43,1898929.25,'Eli Lilly','STEMPHYLIUM SOLANI',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(187,144880,2604075,1130014.83,'Eli Lilly','DIVALPROEX SODIUM',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(151,204188,3208125,1731552.31,'Johnson & Johnson','Niacin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(168,118682,2292546.89,789582.98,'Biogen','Lamotrigine',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(147,164693,3023426,1485390.52,'Biogen','Nortriptyline Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(174,99442,3303186.78,1754344.77,'Eli Lilly','Clobetasol Propionate',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(13,216001,2807831.05,1242490.08,'Johnson & Johnson','Gold Bond Ultimate Healing Concentrate',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(152,75583,3379737.8,1774390.9,'GlaxoSmithKline','Isoniazid',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(7,224342,2313335.25,588699.33,'Johnson & Johnson','Ibuprofen',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(110,155316,1893117.08,134244.15,'Johnson & Johnson','Remicade',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(153,178254,1995651.94,123085.04,'Biogen','Haloperidol',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(12,164685,2938804.92,1065324.19,'AstraZeneca','SKIN FOUNDATION MINERAL MAKEUP',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(79,140129,3560527.35,1582876.55,'AstraZeneca','Green Guard Stomach Relief',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(166,62913,4701990.22,2705112.11,'Bayer','Amitriptyline Hydrochloride',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(129,116649,2933877,934986.87,'Biogen','Cuvposa',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(36,128104,2896459.68,862377.49,'Eli Lilly','Pfizerpen',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(162,130946,3189843.38,1058358.52,'Eli Lilly','Morphine Sulfate',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(132,92089,2443119.04,225171.93,'Eli Lilly','OLUX-E',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(62,140625,3417877.93,1177021.82,'Pfizer','MUCOR PLUMBEUS',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(173,147808,2738142.96,493523.99,'AstraZeneca','Furosemide',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(73,117857,2517600.95,195721.74,'Biogen','Fumaderm',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(163,165666,2843262.48,509536.85,'Pfizer','TAMSULOSIN HYDROCHLORIDE',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(103,102027,3025655,675055.5,'Eli Lilly','Androgel',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(108,136804,3401782.44,992181.28,'Bayer','Sheep Sorrel Pollen',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(114,86112,2825302,412654.26,'Bayer','Claritin',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(55,161870,2835232.18,384241.13,'Johnson & Johnson','Childrens Ibuprofen',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(130,150704,3556698.88,1083810.04,'Johnson & Johnson','Medi-First Cold Relief',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(92,109858,3283823,679925.49,'Eli Lilly','Naratriptan',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(19,128656,3179533.5,410405.24,'Bayer','Ibuprofen PM',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(4,206134,3786377,796869.55,'Sanofi','Lovenox',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(121,140287,3329242.48,261606.11,'AbbVie','Glipizide',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(39,244224,3581454.82,417476.74,'Johnson & Johnson','JUNIPERUS ASHEI POLLEN',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(32,124071,3765829,156664.74,'Johnson & Johnson','XtraCare Foaming Facial Cleanser',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(158,79869,7925929.18,3825914.37,'Merck','Divalproex sodium',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(192,498342,9654492.33,3189863.82,'Eli Lilly','Cialis',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(177,123213,14759462.01,7083504.56,'Novartis','Xanax',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(191,274342,12654492.33,1437439.99,'Sanofi','Dupixent',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(190,240704,13759462.01,2137439.99,'Merck','Keytruda',NULL,NULL,NULL)
--INSERT INTO PHARMACY_SALES VALUES(189,99858,84759462.01,3243809.46,'AbbVie','Humira',NULL,NULL,NULL)

SELECT drug,manufacturer,total_sales,cogs,* FROM PHARMACY_SALES
WHERE total_sales- cogs <0



LOSS =   TOTAL_SALES - COGS

====== - SIGN THEN WE WILL CONSIDER IT AS  A LOSS 




SELECT 
manufacturer, COUNT(DRUG) AS NUM_OF_DRUGS,ABS(SUM(total_sales-cogs)) AS TOTAL_LOSS_ABS 
FROM PHARMACY_SALES p
WHERE total_sales-cogs <0
GROUP BY MANUFACTURER
order by TOTAL_LOSS_ABS DESC





--SELECT 
---357605.76+
---105387.54+
---93464.07+
---12872.99+
---193695.33+
---131887.44

---894913.13


SELECT 
MANUFACTURER,
COUNT(DRUG) AS DRUG_COUNT,-----------------total drugs assosicated with each manufactuerer 
ABS(SUM(TOTAL_SALES-COGS)) AS LOSS
FROM PHARMACY_SALES
WHERE TOTAL_SALES-COGS <0
GROUP BY MANUFACTURER
ORDER BY LOSS DESC



